<?php session_start(); require_once __DIR__.'/../config/db.php'; $errors=[]; if($_SERVER['REQUEST_METHOD']==='POST'){ $email=trim($_POST['email']??''); $pwd=$_POST['password']??''; if(!filter_var($email,FILTER_VALIDATE_EMAIL)) $errors[]='Valid email'; if(!$pwd) $errors[]='Password'; if(empty($errors)){ $s=$conn->prepare('SELECT id,name,password,role FROM users WHERE email=? LIMIT 1'); $s->bind_param('s',$email); $s->execute(); $row=$s->get_result()->fetch_assoc(); if($row && password_verify($pwd,$row['password'])){ if($row['role']!=='admin') $errors[]='Not admin'; else { $_SESSION['admin_id']=$row['id']; $_SESSION['admin_name']=$row['name']; $_SESSION['role']='admin'; header('Location: index.php'); exit; } } else $errors[]='Invalid'; } } ?>
<!doctype html><html><head><meta charset="utf-8"><title>Admin Login</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"></head><body class="bg-light"><div class="container py-5"><div class="row justify-content-center"><div class="col-md-5"><div class="card p-4"><h3>Admin Login</h3><?php if(!empty($errors)) echo '<div class="alert alert-danger">'.implode('<br>',$errors).'</div>'; ?><form method="post"><input class="form-control mb-2" name="email" type="email" placeholder="Email" required><input class="form-control mb-2" name="password" type="password" placeholder="Password" required><button class="btn btn-primary">Login</button></form></div></div></div></div></body></html>